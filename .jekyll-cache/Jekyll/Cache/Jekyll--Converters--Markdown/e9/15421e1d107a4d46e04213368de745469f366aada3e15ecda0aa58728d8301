I"<!-- https://github.com/allrobot/Study-Blog/raw/main/assets/images/ 
$\displaystyle\underbrace{a_i}_{\text{iä»1åˆ°n}}$

$\displaystyle\mathop{a_i}\limits_{i\text{ä»1åˆ°}n}$
-->
<h2 id="éçº¿æ€§æ¨¡å‹">éçº¿æ€§æ¨¡å‹</h2>

<p>å…³äºä½æˆ¿çš„åˆ†ç±»ï¼Œå‡è®¾æˆ¿å­æœ‰å¾ˆå¤šç‰¹å¾ï¼Œé¢ç§¯ã€å§å®¤ã€é—¨ã€æˆ¿é¾„ç­‰ç­‰100å¤šä¸ªå‚æ•°ï¼Œé¢„æµ‹å‡½æ•°è¡¨ç°ä¸ºï¼š</p>

\[\begin{equation*} 

g(\theta_{0}+\theta_{1}x_{2}+\theta_{1}x_{2}+\theta_{3}x_{1}x_{2}+\theta_{4}x_{1}^{2}x_{2}\ldots\theta_{100}x_{99}x_{100}^{2}\ldots

\end{equation*}\]

<p>é€»è¾‘å›å½’çš„äºŒé˜¶å¤šé¡¹å¼äºŒæ¬¡é¡¹æœ‰å¤šå°‘å‘¢ï¼Œé€šè¿‡$\frac{n^2}{2}$å¯çŸ¥å‚æ•°å¤§çº¦5000ä¸ªï¼Œä¸‰é˜¶å¤šé¡¹å¼çº¦17000ä¸ªä¸‰æ¬¡é¡¹ï¼Œç‰¹å¾æ•°å¤ªå¤§ï¼Œä¼šä½¿ç‰¹å¾ç©ºé—´æ€¥å‰§è†¨èƒ€ï¼Œè¿™å¹¶ééçº¿æ€§æ¨¡å‹çš„æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚</p>

<p>å›¾åƒè¯†åˆ«ä¸­ï¼Œæå–è½¦è¾†æŠŠæ‰‹çš„åƒç´ ç‚¹äº®åº¦çŸ©é˜µï¼š</p>

<p><img src="https://github.com/allrobot/Study-Blog/raw/main/assets/images/2022-02-16/1.png" alt="" /></p>

<p><img src="https://github.com/allrobot/Study-Blog/raw/main/assets/images/2022-02-16/2.png" alt="" /></p>

<p>è½¦è¾†å›¾ç‰‡åªæœ‰50x50åƒç´ ç‚¹ï¼Œé‚£ä¹ˆnä¸º2500ä¸ªç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾å€¼èŒƒå›´ä¸º0~255ç°åº¦å€¼ï¼Œå‡å¦‚å›¾ç‰‡ä¸ºå½©è‰²RGBï¼ŒRGBåŒ…å«çº¢è“ç»¿ä¸‰ä¸ªå€¼ï¼Œç‰¹å¾å…±n=7500ä¸ªã€‚</p>

<p>ç°è‰²å›¾ç‰‡çš„2500ä¸ªç‰¹å¾ç”¨æ¥å»ºç«‹éçº¿æ€§æ¨¡å‹ï¼ŒäºŒé˜¶å¤šé¡¹å¼çš„å‚æ•°$\frac{n^2}{2}$çº¦ç­‰äº300ä¸‡ç‰¹å¾ï¼Œè®¡ç®—é‡åºå¤§ï¼Œä¸åˆ©äºè®¡ç®—ã€‚</p>

<h2 id="ç¥ç»ç½‘ç»œ">ç¥ç»ç½‘ç»œ</h2>

<p><img src="https://github.com/allrobot/Study-Blog/raw/main/assets/images/2022-02-16/3.png" alt="" /></p>

<p>$a_{i}^{(j)}$=ç¬¬jå±‚ç¬¬iä¸ªçš„æ¿€æ´»è¾“å‡º</p>

<p>$\theta^{(j)}$=ç¬¬jå±‚æ˜ å°„åˆ°j+1å±‚çš„å‚æ•°çŸ©é˜µ</p>

<p>ç¬¬jå±‚ç¥ç»ç½‘ç»œæœ‰$s_{j}$ä¸ªç¥ç»å•å…ƒï¼Œç¬¬$j+1$å±‚æœ‰$s_{j+1}$ç¥ç»å•å…ƒï¼Œæ­¤æ—¶$\theta^{(j)}$å‚æ•°çš„ç»´åº¦ä¸º$s_{j+1}*(s_{j}+1)$</p>

<p>ç¬¬ä¸€å±‚çš„ç¥ç»ç½‘ç»œæœ‰3ä¸ªç¥ç»å•å…ƒï¼Œç¬¬äºŒå±‚æœ‰3ä¸ªç¥ç»å•å…ƒï¼Œç¬¬ä¸€å±‚ä¸ç¬¬äºŒå±‚çš„å‚æ•°$\theta$ä¸º3*(3+1)=12ä¸ª</p>

\[\begin{equation*} 

a_{1}^{(2)}=g(\theta_{10}^{(1)}x_{0}+\theta_{11}^{(1)}x_{1}+\theta_{12}^{(1)}x_{2}+\theta_{13}^{(1)}x_{3})  \\
a_{1}^{(2)}=g(\theta_{20}^{(1)}x_{0}+\theta_{21}^{(1)}x_{1}+\theta_{22}^{(1)}x_{2}+\theta_{23}^{(1)}x_{3})  \\
a_{1}^{(2)}=g(\theta_{30}^{(1)}x_{0}+\theta_{31}^{(1)}x_{1}+\theta_{32}^{(1)}x_{2}+\theta_{33}^{(1)}x_{3})  \\
h_{\theta}(x)=a_{1}^(3)=g(\theta_{10}^{(2)}a_{0}+\theta_{11}^{(2)}a_{1}+\theta_{12}^{(2)}a_{2}+\theta_{13}^{(2)}a_{3})

\end{equation*}\]

<h3 id="ä¸€å¯¹å¤š">ä¸€å¯¹å¤š</h3>

<p><img src="https://github.com/allrobot/Study-Blog/raw/main/assets/images/2022-02-16/4.png" alt="å››å±‚ç¥ç»ç½‘ç»œ" /></p>

<p>å¸Œæœ›æ¨¡å‹yèƒ½è¾“å‡ºæ­¥äººæ—¶[1 0 0 0]ï¼Œè¾“å‡ºæ±½è½¦æ—¶[0 1 0 0]ï¼Œè¾“å‡ºæ‘©æ‰˜è½¦æ—¶[0 0 1 0]ç­‰ç­‰ã€‚</p>

<h3 id="æŸå¤±å‡½æ•°">æŸå¤±å‡½æ•°</h3>

<p><img src="https://github.com/allrobot/Study-Blog/raw/main/assets/images/2022-02-16/5.png" alt="" /></p>

<p>L=ç¥ç»ç½‘ç»œçš„å±‚æ•°</p>

<p>$s_{l}$=ç¬¬lå±‚çš„ç¥ç»ç½‘ç»œç¥ç»å•å…ƒæ•°é‡</p>

<p>äºŒåˆ†ç±»ï¼Œé€šå¸¸yè¾“å‡º0æˆ–1æ¥è¡¨ç¤ºï¼Œè¾“å‡ºå±‚çš„ç¥ç»å•å…ƒåªæœ‰1ä¸ªï¼Œ$h_{\theta}(x)\epsilon R$,$s_{l}$=1ï¼ŒK=1ã€‚</p>

<p>å¤šåˆ†ç±»ï¼Œå››å±‚ç¥ç»ç½‘ç»œçš„$h_{\theta}(x)=R^{k}$ï¼Œ$s_{l}=K\ (k\ge 3)$ï¼Œç¥ç»å•å…ƒè‡³å°‘3ä¸ªä»¥ä¸Šã€‚</p>

<p>é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°ï¼š</p>

\[\begin{equation*}
  J(\theta)=-\frac{1}{m}[\displaystyle\sum\limits_{i=1}^{m}y^{(i)}log h_{\theta}(x^{(i)})+(1-y^{(i)})log(1-h_{\theta}(x))]+\frac{\lambda}{2m}\sum\limits_{j=1}^{n}\theta_{j}^{2}  \\
\end{equation*}\]

<p>ç¥ç»ç½‘ç»œçš„æŸå¤±å‡½æ•°ï¼š</p>

\[\begin{equation*}
  h_{\theta}(x)=R^{k}\ (h_{\theta}(x))_{i}=i^{th}output  \\
  J(\theta)=-\frac{1}{m}[\sum\limits_{i=1}^{m}\sum\limits_{k=1}^{K}y_{k}^{(i)}log (h_{\theta}(x^{(i)}))_{k}+(1-y_{k}^{(i)})log(1-(h_{\theta}(x))_{k})]+\frac{\lambda}{2m}\sum\limits_{l=1}^{L-1}\sum\limits_{i=1}^{s_l}\sum\limits_{j=1}^{s_{l}+1}(\theta_{ji}^{(l)})^{2}  \\
\end{equation*}\]

<p>mä¸ªè®­ç»ƒæ ·æœ¬ï¼ŒKä¸ªè¾“å‡ºå±‚çš„ç¥ç»å•å…ƒï¼Œå…±L-1å±‚çš„ç¥ç»ç½‘ç»œï¼Œç¬¬lå±‚çš„ç¥ç»å•å…ƒä¸ªæ•°ï¼Œç¬¬lå±‚çš„ç¥ç»å•å…ƒæ€»æ•°+1</p>

<h2 id="åå‘ä¼ æ’­ç®—æ³•">åå‘ä¼ æ’­ç®—æ³•</h2>

<h3 id="æ¢¯åº¦ä¸‹é™ç®—æ³•">æ¢¯åº¦ä¸‹é™ç®—æ³•</h3>

<p>è¦æ±‚$\mathop{min}\limits_{\theta}J(\theta)$ï¼Œéœ€è¦ä¸¤ä¸ªæ¡ä»¶ï¼š<br />
	- $J(\theta)$<br />
	- $\frac{\partial}{\partial\theta_{ij}^{(l)}}J(\theta)$</p>

<p>å…ˆè®¡ç®—ä»ç¬¬ä¸€å±‚çš„å‚æ•°åˆ°ç¬¬å››å±‚çš„å€¼ï¼Œè®¡ç®—è¿‡ç¨‹å…·ä½“å‚è§<a href="https://www.zybuluo.com/hanbingtao/note/476663">https://www.zybuluo.com/hanbingtao/note/476663</a></p>

<p>ç¬¬å››å±‚çš„è¾“å‡ºå±‚çš„è¯¯å·®é¡¹ï¼š$\delta_{j}^{(4)}=a_{j}^{(4)}-y_{j}$</p>

<p>ç¬¬ä¸‰å±‚çš„éšè—å±‚çš„è¯¯å·®é¡¹è®¡ç®—ï¼š$(\delta^{(3)}=(\theta^(3))^{T}\delta^{(4)}.*$gâ€™(z^{(3)})=a^{(3)}$.*(1-a^{(3)})$</p>

<p>ç¬¬äºŒå±‚çš„$(\delta^{(2)}=(\theta^(2))^{T}\delta^{(3)}$.*gâ€™$(z^{(2)})=a^{(2)}.*(1-a^{(2)})$</p>

<p><img src="https://github.com/allrobot/Study-Blog/raw/main/assets/images/2022-02-16/6.png" alt="" /></p>

<p>$\frac{\partial}{\partial\theta_{ij}^{(l)}}J(\theta)$çš„åå¯¼æ•°ä¸º$a_{j}^{(l)}\delta{i}^{(l+1)}$</p>

<h3 id="åå‘ä¼ æ’­è¿‡ç¨‹">åå‘ä¼ æ’­è¿‡ç¨‹</h3>

<p>è®­ç»ƒé›†${(x^{(1)},y^{(1)}),\ldots,(x^{(m)},y^{(m)})}$</p>

<p>è®¾$\Delta_{ij}^{(l)}=0\ (\text{for all}\ l,i,j)$ï¼Œå…¶ä¸­çš„$\Delta$æ˜¯$\delta$çš„å¤§å†™ï¼Œå®ƒè®¾ä¸€ä¸ªå…¨é›¶çš„è¯¯å·®é¡¹çŸ©é˜µï¼Œ$\delta$ä½œä¸ºç´¯åŠ é¡¹åœ¨è¿­ä»£ä¸­å¢åŠ <br />
$\text{For}\ i=1\ to\ m$:<br />
$\qquad$è®¾$a^{(1)}=x^{(i)}$ï¼ŒæŠŠç¬¬iä¸ªè®­ç»ƒæ ·æœ¬çš„å€¼è¾“å…¥åˆ°ç¬¬ä¸€å±‚<br />
$\qquad$å‘å‰ä¼ æ’­è®¡ç®—$a^{(l)}\ \text{for}\ l=2,3,\ldots,L$ï¼Œä»è¾“å…¥å±‚å‰å‘è®¡ç®—åˆ°è¾“å‡ºå±‚<br />
$\qquad$ä½¿ç”¨$y^{(i)}$è®¡ç®—$\delta^{(L)}=a^{(L)}-y^{(i)}$ï¼Œè®¡ç®—è¾“å‡ºå±‚çš„è¯¯å·®é¡¹<br />
$\qquad$è®¡ç®—$\delta^{(L-1)},\delta^(L-2),\ldots,\delta^{(2)}$ï¼Œé€ä¸ªä»L-1å±‚åˆ°ç¬¬äºŒå±‚çš„è¯¯å·®é¡¹ä¼ æ’­è®¡ç®— (ä¸è€ƒè™‘è¾“å…¥å±‚çš„è¯¯å·®é¡¹)<br />
$\qquad$$\Delta_{ij}^{(l)}:=\Delta_{ij}^{(l)}+a_{j}^{(l)}\delta_{i}^{(l+1)}$ ç´¯åŠ è¯¯å·®é¡¹<br /></p>

\[\begin{equation*}
  D_{ij}^{(l)}:=\frac{1}{m}\Delta_{ij}^{(l)}+\lambda\theta_{ij}^{(l)}\ \text{if}\ j\ \ne\ 0  \\
  D_{ij}^{(l)}:=\frac{1}{m}\Delta_{ij}^{(l)}\qquad\qquad \text{if}\ j\ =\ 0  \\
  \frac{\partial}{\partial\theta_{ij}^{(l)}}J(\theta)=D_{ij}^{(l)}
\end{equation*}\]

<h3 id="åå‘ä¼ æ’­ç®—æ³•-1">åå‘ä¼ æ’­ç®—æ³•</h3>

\[\begin{equation*}
  J(\theta)=-\frac{1}{m}[\sum\limits_{i=1}^{m}\sum\limits_{k=1}^{K}y_{k}^{(i)}log (h_{\theta}(x^{(i)}))_{k}+(1-y_{k}^{(i)})log(1-(h_{\theta}(x))_{k})]+\frac{\lambda}{2m}\sum\limits_{l=1}^{L-1}\sum\limits_{i=1}^{s_l}\sum\limits_{j=1}^{s_{l}+1}(\theta_{ji}^{(l)})^{2} 
\end{equation*}\]

<p>è¿™ç§é€‚ç”¨äºä¸€ä¸ªè¾“å‡ºå•å…ƒ(K=1)çš„æƒ…å†µï¼Œå¤šä¸ªè¾“å‡ºå°±è¦è®¾$\lambda$ä¸º0</p>

\[\begin{equation*}
  J(\theta)=-\frac{1}{m}[\sum\limits_{i=1}^{m}\sum\limits_{k=1}^{K}y_{k}^{(i)}log (h_{\theta}(x^{(i)}))_{k}+(1-y_{k}^{(i)})log(1-(h_{\theta}(x))_{k})]  \\
\end{equation*}\]

<p>æŸå¤±å‡½æ•°$cost(i)=y^{(i)}log (h_{\theta}(x^{(i)}))+(1-y^{(i)})log(1-(h_{\theta}(x)))$ï¼Œå¯ä»¥è®¤ä¸ºè¿‘ä¼¼äº$cost(i)\approx(h_{\theta}(x^{(i)}-y^{(i)})^2$</p>

<p>$\delta_{j}^{(l)}=$ç¬¬lå±‚çš„æ¯ä¸ª$a_{j}^{(l)}$çš„æŸå¤±å‡½æ•°å€¼</p>

<p>å½¢å¼ä¸Šï¼Œ$\delta_{j}^{(l)}=\frac{\partial}{\partial z_{j}^{(l)}}cost(i)\qquad (j\ge 0)$ï¼Œå³$cost(i)=y^{(i)}log (h_{\theta}(x^{(i)}))+(1-y^{(i)})log(1-(h_{\theta}(x)))$</p>

<h2 id="æ¢¯åº¦æ£€éªŒ">æ¢¯åº¦æ£€éªŒ</h2>

:ET